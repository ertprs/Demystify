<div class="portlet box green">
    <div class="portlet-title col-md-12">
        <div class="caption col-md-6">
            <i class="fa fa-tasks"></i>User
        </div>
    </div>
    <div class="portlet-body">
        <form (ngSubmit)="OnSubmitUpdateProfile(frmProfile)" [formGroup]="frmProfile" novalidate>
            <div class="row">
                <div class="col-md-12">
                    <div *ngIf="errorMessage" class="col-md-12 alert alert-danger" style="margin-bottom:15px;">
                        <a class="close" data-close="alert"></a>
                        <span [innerHtml]="errorMessage"></span>
                    </div>
                    <div *ngIf="successMessage" class="col-md-12 alert alert-success" style="margin-bottom:15px;">
                        <a class="close" data-close="alert"></a>
                        <span [innerHtml]="successMessage"></span>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-bottom:15px;">
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <input type="text" class="form-control" formControlName="UserName" />
                        <label>UserName</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.UserName.errors?.required && isSubmitedUserProfile"> Please enter UserName </span>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.UserName.errors?.email && !frmProfile.controls.UserName.errors?.required && isSubmitedUserProfile"> Please enter proper UserName </span>
                </div>
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <input type="text" class="form-control" formControlName="Mobile" />
                        <label>Mobile</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.Mobile.errors?.required && isSubmitedUserProfile"> Please enter Mobile </span>
                </div>
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <input type="text" class="form-control" formControlName="FirstName" />
                        <label>FirstName</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.FirstName.errors?.required && isSubmitedUserProfile"> Please enter FirstName </span>
                </div>
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <input type="text" class="form-control" formControlName="LastName" />
                        <label>LastName</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.LastName.errors?.required && isSubmitedUserProfile"> Please enter LastName </span>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <select class="form-control" formControlName="Gender">
                            <option value="">Select your Gender</option>
                            <option value="Female">Female</option>
                            <option value="Male">Male </option>
                        </select>
                        <label>Gender</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.Gender.errors?.required && isSubmitedUserProfile"> Please select Gender </span>
                </div>
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <input type="text" class="form-control" formControlName="CompanyName" />
                        <label>CompanyName</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.CompanyName.errors?.required && isSubmitedUserProfile"> Please enter CompanyName </span>
                </div>
                <div class="col-md-3">
                    <div class="form-group form-md-line-input no-margin">
                        <select class="form-control" formControlName="ProfessionalQualificationId">
                            <option *ngFor="let item of professionalQualifications" [value]="item.Value">{{item.Text}}</option>
                        </select>
                        <label>Professional Qualification</label>
                    </div>
                    <span class="help-block has-error" *ngIf="frmProfile.controls.ProfessionalQualificationId.errors?.required && isSubmitedUserProfile"> Please select Professional Qualification </span>
                </div>
            </div>

            <div class="form-actions text-right btn-outer-background no-space-right form-actions-bottom-padding row-top-margin">
                <a (click)="CancelSubscription()" class="btn btn-default">Back To List</a>
                <input class="btn btn-primary btn-cancel-margin" type="submit" value="Save">
            </div>
        </form>
    </div>
</div>

<div class="portlet box green" *ngIf="subscriptions && subscriptions.length > 0 && !isSubscriptionAdded">
    <div class="portlet-title col-md-12">
        <div class="caption col-md-6">
            <i class="fa fa-tasks"></i>Subscription
        </div>
    </div>
    <div class="portlet-body">
        <form novalidate (ngSubmit)="OnSubmitSubscription(frmSubscription)" [formGroup]="frmSubscription">
            <div class="row" *ngIf="subscriptions && subscriptions.length > 0">
                <div class="col-md-3">
                    <div class="form-group  form-md-line-input">
                        <div class="col-md-3 no-space"><label>Package: </label></div>
                        <div class="col-md-9 no-space"><label class="text-left-margin">{{subscriptions[0].PackageName}}</label></div>
                    </div>
                </div>
                <!--<div class="col-md-3" *ngIf="isSubscriptionAdded">
                    <div class="form-group  form-md-line-input">
                        <div class="col-md-4 no-space"><label>Start Date : </label></div>
                        <div class="col-md-8 no-space"><label class="text-left-margin">{{subscription.StartDate | date:'dd-MM-yyyy'}}</label></div>
                    </div>
                </div>
                <div class="col-md-3" *ngIf="isSubscriptionAdded">
                    <div class="form-group  form-md-line-input">
                        <div class="col-md-5 no-space"><label>Payment Date : </label></div>
                        <div class="col-md-7 no-space"><label class="text-left-margin">{{subscription.PaymentDate | date:'dd-MM-yyyy'}}</label></div>
                    </div>
                </div>-->
            </div>
            <div class="row row-top-margin">
                <div class="col-md-3">
                    <div class="input-group">
                        <!--<label class="no-margin">Payment Date</label>-->
                        <!--<input class="form-control" placeholder="dd-mm-yyyy" [minDate]="minDate" name="dp" formControlName="PaymentDate" [value]="(frmSubscription.controls.PaymentDate.value) ? (frmSubscription.controls.PaymentDate.value.day + '-' + frmSubscription.controls.PaymentDate.value.month + '-' + frmSubscription.controls.PaymentDate.value.year) : frmSubscription.controls.PaymentDate.value" readonly="readonly" #dp="ngbDatepicker" ngbDatepicker>
                        <div class="input-group-btn" style="vertical-align: bottom !important;">
                            <button class="btn btn-outline-secondary" (click)="dp.toggle()" type="button">
                                <img src="../../../../assets/images/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;" />
                            </button>
                        </div>
                        <div class="input-group-btn" style="padding: 0 5px !important; vertical-align: bottom !important;">
                            <span class="input-group-btn">
                                <button class="btn blue bold" type="button" (click)="ClearPaymentDate()"><i class="fa fa-remove"></i></button>
                            </span>
                        </div>-->
                    </div>

                    <div class="input-group">
                        <label class="no-margin">Payment Date</label>
                        <input class="form-control" placeholder="dd-mm-yyyy" readonly="readonly" [value]="(frmSubscription.controls.PaymentDate.value) ? (frmSubscription.controls.PaymentDate.value.day + '-' + frmSubscription.controls.PaymentDate.value.month + '-' + frmSubscription.controls.PaymentDate.value.year) : frmSubscription.controls.PaymentDate.value" />
                        <div class="input-group-btn" style="vertical-align: bottom !important;">
                            <button class="btn btn-outline-secondary" (click)="isPaymentDatePicker = !isPaymentDatePicker" type="button">
                                <img src="../../../../assets/images/calendar-icon.svg" style="width: 1.2rem; height: 2rem; cursor: pointer;vertical-align: top;" />
                            </button>
                        </div>
                    </div>
                    <ngb-datepicker #dp (select)="isPaymentDatePicker = !isPaymentDatePicker; OnChangePaymentDate()" formControlName="PaymentDate" [minDate]="minDate" *ngIf="isPaymentDatePicker">
                    </ngb-datepicker>

                    <span class="help-block has-error" *ngIf="frmSubscription.controls.PaymentDate.errors?.required && isSubmited"> Please enter Payment Date </span>
                </div>
                <div class="col-md-3">
                    <div class="input-group">
                        <label class="no-margin">Start Date</label>
                        <input class="form-control" placeholder="dd-mm-yyyy" [minDate]="minStartDate" name="dp" formControlName="StartDate" [value]="(frmSubscription.controls.StartDate.value) ? (frmSubscription.controls.StartDate.value.day + '-' + frmSubscription.controls.StartDate.value.month + '-' + frmSubscription.controls.StartDate.value.year) : frmSubscription.controls.StartDate.value" readonly="readonly" #d="ngbDatepicker" ngbDatepicker>
                        <div class="input-group-btn" style="vertical-align: bottom !important;">
                            <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button">
                                <img src="../../../../assets/images/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;" />
                            </button>
                        </div>
                        <div class="input-group-btn" style="padding: 0 5px !important; vertical-align: bottom !important;">
                            <span class="input-group-btn">
                                <button class="btn blue bold" type="button" (click)="ClearStartDate()"><i class="fa fa-remove"></i></button>
                            </span>
                        </div>
                    </div>
                    <span class="help-block has-error" *ngIf="frmSubscription.controls.StartDate.errors?.required && isSubmited"> Please enter Start Date </span>
                </div>
            </div>

            <div class="form-actions text-right btn-outer-background no-space-right form-actions-bottom-padding row-top-margin">
                <input class="btn btn-primary" type="submit" value="Save" *ngIf="!isSubscriptionAdded">
            </div>
        </form>
    </div>
</div>

<div class="portlet box green">
    <div class="portlet-title col-md-12">
        <div class="caption col-md-6">
            <i class="fa fa-tasks"></i>Subscription History
        </div>
    </div>
    <div class="portlet-body">
        <div class="row">
            <div class="col-md-1">
                <select class="form-control" (change)="OnPageSizeChange()" [(ngModel)]="drpPageSize">
                    <option *ngFor="let size of pageSizes">{{size}}</option>
                </select>
            </div>
            <div class="col-sm-3 col-sm-offset-8">
                <form novalidate (ngSubmit)="SearchSubscriptionHistory(frmSubscriptionHistory)" [formGroup]="frmSubscriptionHistory">
                    <div class="input-group stylish-input-group">
                        <input type="text" class="form-control" placeholder="Search here" formControlName="SearchText" #txtSearch>
                        <span class="input-group-addon">
                            <button type="submit">
                                <span class="glyphicon glyphicon-search"></span>
                            </button>
                        </span>
                    </div>
                </form>
            </div>
        </div>

        <div class="table-scrollable">
            <input type="hidden" id="hdnCurrentPage" value="0" />
            <table class="table table-striped table-responsive table-advance table-hover">
                <thead>
                    <tr class="grey-mint">
                        <th (click)="OnSubscriptionHistorySort('PackageName')" class="pointer-cursor">Package <i class="fa {{sortingSubscriptionHistoryField == 'PackageName' ? (sortingSubscriptionHistoryDirection == 'A' ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort sort-opacity'}}"></i></th>
                        <th (click)="OnSubscriptionHistorySort('StartDate')" class="pointer-cursor">Start Date <i class="fa {{sortingSubscriptionHistoryField == 'StartDate' ? (sortingSubscriptionHistoryDirection == 'A' ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort sort-opacity'}}"></i></th>
                        <th (click)="OnSubscriptionHistorySort('EndDate')" class="pointer-cursor">End Date <i class="fa {{sortingSubscriptionHistoryField == 'EndDate' ? (sortingSubscriptionHistoryDirection == 'A' ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort sort-opacity'}}"></i></th>
                        <th (click)="OnSubscriptionHistorySort('SubscriptionStatus')" class="pointer-cursor">Subscription Status <i class="fa {{sortingSubscriptionHistoryField == 'SubscriptionStatus' ? (sortingSubscriptionHistoryDirection == 'A' ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort sort-opacity'}}"></i></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngIf="!subscriptionHistories">
                        <td colspan="6" class="text-center"><label>Loading data. Please wait...</label></td>
                    </tr>
                    <tr *ngIf="subscriptionHistories && subscriptionHistories.length == 0">
                        <td colspan="6" class="text-center"><label>No Subscription History Found!</label></td>
                    </tr>
                    <ng-template ngFor let-subscriptionHistory let-i="index" [ngForOf]="subscriptionHistories">
                        <tr class="text-nowrap">
                            <td>{{subscriptionHistory.PackageName}}</td>
                            <td>{{subscriptionHistory.StartDate | date:'dd-MM-yyyy'}}</td>
                            <td>{{subscriptionHistory.EndDate | date:'dd-MM-yyyy'}}</td>
                            <td><span [ngStyle]="{'color': colourCode[subscriptionHistory.SubscriptionStatus]}">{{subscriptionHistory.SubscriptionStatus}}</span></td>
                        </tr>
                    </ng-template>
                </tbody>
            </table>
        </div>
        <div class="row">
            <div class="col-md-12 text-right">
                <ngb-pagination *ngIf="totalRecords" [collectionSize]="totalRecords" [(page)]="currentPage" [maxSize]="5" [rotate]="true" (pageChange)="OnPageChange($event)" [pageSize]="pageSize" [boundaryLinks]="true"></ngb-pagination>
            </div>
        </div>
    </div>
</div>